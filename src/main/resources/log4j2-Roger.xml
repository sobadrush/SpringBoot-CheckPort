<?xml version="1.0" encoding="UTF-8"?>
<Configuration status="warn" name="MyApp">
    <Properties>
        <Property name="app_name">SpringBoot-CheckPort</Property>
        <Property name="baseDir">D:/logs</Property>
        <Property name="logMsg_pattern">%d{yyyy-MM-dd HH:mm:ss} [%-5p] %c %L %M - %msg%xEx%n</Property>
    </Properties>
    <Appenders>

        <Console name="ConsoleAppender" target="SYSTEM_OUT">
            <PatternLayout pattern="${logMsg_pattern}" />
        </Console>

                        <!-- filePattern="${baseDir}/$${date:yyyy-MM}/${app_name}-%d{yyyy-MM-dd HH-mm}-%i.log.gz"> -->
        <RollingFile name="RollingFileAppender" fileName="${baseDir}/${app_name}.log"
                        filePattern="${baseDir}/${app_name}-%d{yyyy-MM-dd HH-mm}-%i.log.gz">
            <PatternLayout pattern="${logMsg_pattern}"/>
            <Policies>
                <!-- <TimeBasedTriggeringPolicy interval="1"/> --> <!-- 與 filePattern 最小時間單位匹配，ex: 若為 mm ，則為每1分鐘 -->
                <CronTriggeringPolicy schedule="0 * * * * ?"/> <!-- 每 1分鐘 觸發一次 -->
                <OnStartupTriggeringPolicy/> <!-- 在應用程式啟動時觸發一次日誌事件 -->
                <!-- <SizeBasedTriggeringPolicy size="500KB"/> -->
            </Policies>
            <DefaultRolloverStrategy max="3"> <!-- 與 filePattern 的 %i 相關，每分鐘最多產生 3 個檔案-->
                <Delete basePath="${baseDir}" maxDepth="2">
                    <!-- <IfFileName glob="*/app-*.log.gz"/> -->
                    <IfFileName glob="${app_name}-*.log.gz"/>
                    <!-- <IfLastModified age="90d"/> &lt;!&ndash; 最後修改時間 > 90天 以上的檔案會被刪除 &ndash;&gt; -->
                    <IfLastModified age="5m"/> <!-- 最後修改時間 > 3分鐘以上 的檔案會被刪除 -->
                </Delete>
            </DefaultRolloverStrategy>
        </RollingFile>
    </Appenders>
    <Loggers>
        <Root level="info">
            <AppenderRef ref="ConsoleAppender"/>
            <AppenderRef ref="RollingFileAppender"/>
        </Root>
    </Loggers>
</Configuration>